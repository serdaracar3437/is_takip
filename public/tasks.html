<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Görev Girişi</title>

  <style>
    body {
      background: #f4f4f4;
      font-family: Arial;
      padding: 20px;
      color: #333;
    }
    h2 {
      color: #ff6f00;
      margin-bottom: 10px;
    }
    input, textarea, select {
      width: 300px;
      padding: 8px;
      margin: 5px 0;
      border-radius: 4px;
      border: 1px solid #bbb;
    }
    button {
      background-color: #ff6f00;
      border: none;
      color: white;
      padding: 10px 20px;
      margin-top: 10px;
      cursor: pointer;
      border-radius: 5px;
      font-weight: bold;
    }
    button:hover {
      background-color: #e65c00;
    }

    /* --- TABLO TASARIMI --- */
    table {
      width: 100%;
      margin-top: 40px;
      border-collapse: collapse;
      background: white;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    table th {
      background: #ff6f00;
      color: white;
      padding: 10px;
      text-align: left;
      position: sticky;
      top: 0;
    }
    table td {
      padding: 10px;
      border-bottom: 1px solid #ddd;
    }
    tr:hover {
      background: #fff5e6;
    }
  </style>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

  <h2>Görev Girişi</h2>

  <input id="username" placeholder="Ad Soyad"><br>
  <input id="isemri_numarasi" placeholder="İş Emri Numarası"><br>
  <input id="urun_kodu" placeholder="Ürün Kodu"><br>
  <input type="date" id="tarih"><br>
  <input id="yapilan_faaliyet" placeholder="Yapılan Faaliyet"><br>
  <textarea id="aciklama" placeholder="Açıklama"></textarea><br>
  <input id="kullanilan_malzeme" placeholder="Kullanılan Malzeme"><br>
  <label>Başlama: </label><input type="time" id="baslama_saati"><br>
  <label>Bitiş: </label><input type="time" id="bitis_saati"><br>
  <input id="islem_adedi" placeholder="İşlem Adedi"><br>

  <h3>Hatalar</h3>
  <input id="hata_kodu1" placeholder="Hata Kodu 1">
  <input id="hata_sayisi1" placeholder="Hata Sayısı 1"><br>

  <input id="hata_kodu2" placeholder="Hata Kodu 2">
  <input id="hata_sayisi2" placeholder="Hata Sayısı 2"><br>

  <input id="hata_kodu3" placeholder="Hata Kodu 3">
  <input id="hata_sayisi3" placeholder="Hata Sayısı 3"><br>

  <button onclick="saveTask()">Kaydet</button>

  <hr><br>

  <h2>Kayıtlı Görevler</h2>

  <!-- TABLO ALANI -->
  <table id="taskTable">
    <thead>
      <tr>
        <th>Personel</th>
        <th>İş Emri</th>
        <th>Ürün Kodu</th>
        <th>Tarih</th>
        <th>Faaliyet</th>
        <th>Açıklama</th>
        <th>Malzeme</th>
        <th>Başlama</th>
        <th>Bitiş</th>
        <th>Adet</th>
        <th>Hata 1</th>
        <th>Sayı 1</th>
        <th>Hata 2</th>
        <th>Sayı 2</th>
        <th>Hata 3</th>
        <th>Sayı 3</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

<script>

const supabase = supabase.createClient(
  "YOUR_SUPABASE_URL",
  "YOUR_SUPABASE_ANON_KEY"
);


// -------------------- GÖREV KAYDET --------------------
async function saveTask() {

  const task = {
    username: username.value,
    isemri_numarasi: isemri_numarasi.value,
    urun_kodu: urun_kodu.value,
    tarih: tarih.value,
    yapilan_faaliyet: yapilan_faaliyet.value,
    aciklama: aciklama.value,
    kullanilan_malzeme: kullanilan_malzeme.value,
    baslama_saati: baslama_saati.value,
    bitis_saati: bitis_saati.value,
    islem_adedi: islem_adedi.value,
    hata_kodu1: hata_kodu1.value,
    hata_sayisi1: hata_sayisi1.value,
    hata_kodu2: hata_kodu2.value,
    hata_sayisi2: hata_sayisi2.value,
    hata_kodu3: hata_kodu3.value,
    hata_sayisi3: hata_sayisi3.value,
  };

  const { error } = await supabase.from("tasks").insert(task);

  if (error) {
    alert("Kayıt hatası: " + error.message);
    return;
  }

  alert("Görev başarıyla kaydedildi!");
  loadTasks();
}



// -------------------- TABLOYU YÜKLE --------------------
async function loadTasks() {
  const { data, error } = await supabase.from("tasks").select("*");

  if (error) {
    alert("Veri çekme hatası: " + error.message);
    return;
  }

  const tbody = document.querySelector("#taskTable tbody");
  tbody.innerHTML = "";

  data.forEach(t => {
    const row = `
      <tr>
        <td>${t.username}</td>
        <td>${t.isemri_numarasi}</td>
        <td>${t.urun_kodu}</td>
        <td>${t.tarih}</td>
        <td>${t.yapilan_faaliyet}</td>
        <td>${t.aciklama}</td>
        <td>${t.kullanilan_malzeme}</td>
        <td>${t.baslama_saati}</td>
        <td>${t.bitis_saati}</td>
        <td>${t.islem_adedi}</td>
        <td>${t.hata_kodu1}</td>
        <td>${t.hata_sayisi1}</td>
        <td>${t.hata_kodu2}</td>
        <td>${t.hata_sayisi2}</td>
        <td>${t.hata_kodu3}</td>
        <td>${t.hata_sayisi3}</td>
      </tr>
    `;
    tbody.innerHTML += row;
  });
}

loadTasks();

</script>

</body>
</html>
