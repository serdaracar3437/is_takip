<!DOCTYPE html>
.row{display:flex;gap:10px;flex-wrap:wrap;}
.btn{background:#ff6f00;color:white;border:none;padding:10px 16px;border-radius:8px;font-weight:700;cursor:pointer;}
ul{list-style:none;padding:0;margin-top:10px;}
li{padding:10px;border-radius:8px;background:#f8f9ff;margin-bottom:8px;border:1px solid #eceef5;}
.tag{display:inline-block;padding:4px 8px;border-radius:6px;font-size:12px;background:#2c003e;color:white;margin-left:6px;}
</style>
</head>
<body>
<div class="header">Yönetici Paneli</div>
<div class="wrap">


<section class="card">
<h2>Kullanıcı Ekle</h2>
<div class="row">
<input id="newUser" placeholder="kullanıcı adı" />
<input id="newPass" type="password" placeholder="şifre" />
<select id="newRole"><option value="personel">Personel</option><option value="admin">Admin</option></select>
<button class="btn" onclick="addUser()">Ekle</button>
</div>
</section>


<section class="card">
<h2>Personel Listesi</h2>
<button class="btn" onclick="loadPersonel()">Yenile</button>
<ul id="personelList"></ul>
</section>


<section class="card">
<h2>Son Görevler</h2>
<button class="btn" onclick="loadTasks()">Listele</button>
<ul id="taskList"></ul>
</section>


<a href="logout.html">Çıkış Yap</a>
</div>


<script>
async function addUser(){
const username=newUser.value.trim();
const password=newPass.value.trim();
const role=newRole.value;
if(!username||!password){alert("Bilgiler boş olamaz");return;}


const res=await fetch("/api/addUser",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({username,password,role})
});
const json=await res.json();
if(!res.ok){alert(json.error||"Hata");return;}
alert("Kullanıcı eklendi");
newUser.value="";newPass.value="";
}


async function loadPersonel(){
const res=await fetch("/api/personel");
const data=await res.json();
personelList.innerHTML="";
data.forEach(u=>{
const li=document.createElement("li");
li.innerHTML=`${u.username} <span class='tag'>${u.role}</span>`;
personelList.appendChild(li);
});
}


async function loadTasks(){
const res=await fetch("/api/tasks");
const data=await res.json();
taskList.innerHTML="";
data.slice(0,50).forEach(t=>{
const li=document.createElement("li");
li.innerHTML=`<strong>${t.username}</strong> — ${t.isemri_numarasi||"-"} — ${t.tarih||"-"}`;
taskList.appendChild(li);
});
}
</script>
</body>
</html>