<!DOCTYPE html>
<html lang="tr">

<button id="logoutBtn" class="logout-button">Çıkış Yap</button>

<script>
document.getElementById("logoutBtn").addEventListener("click", async () => {
  if (confirm("Çıkış yapmak istediğine emin misin?")) {
    const response = await fetch("/api/logout", { method: "POST" });
    const data = await response.json();
    if (data.success) {
      window.location.href = data.redirect;
    } else {
      alert("Çıkış yapılamadı!");
    }
  }
});
</script>

<head>
  <meta charset="UTF-8">
  <title>Yönetici Sayfası</title>
  <style>

    .logout-button {
  position: absolute;
  top: 20px;
  right: 20px;
  background: linear-gradient(135deg, #ff8c00, #800080);
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 10px;
  cursor: pointer;
  font-size: 14px;
  transition: all 0.3s ease;
}
.logout-button:hover {
  background: linear-gradient(135deg, #800080, #ff8c00);
  transform: scale(1.05);
}

    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #3a0ca3, #f08a5d);
      color: #fff;
      margin: 0;
      padding: 20px;
    }

    h2 { margin-top: 0; }

    input, button {
      padding: 8px;
      margin: 5px 0;
      border-radius: 6px;
      border: none;
      font-size: 14px;
    }

    button {
      background-color: #f08a5d;
      color: #fff;
      font-weight: bold;
      cursor: pointer;
    }

    button:hover { background-color: #e07b4f; }

    .form-container {
      background: rgba(0,0,0,0.6);
      padding: 20px;
      border-radius: 12px;
      width: 400px;
      margin-bottom: 20px;
    }

    ul { padding-left: 0; list-style: none; }
    li { padding: 5px 0; background: rgba(255,255,255,0.1); margin-bottom: 5px; border-radius: 6px; }
  </style>
</head>
<body>

<h2>Yönetici Paneli</h2>

<div class="form-container">
  <h3>Yeni Personel Ekle</h3>
  <input type="text" id="username" placeholder="Kullanıcı Adı">
  <input type="password" id="password" placeholder="Şifre">
  <button onclick="addPersonel()">Ekle</button>
</div>

<h3>Personel Listesi</h3>
<ul id="personelList"></ul>
<button onclick="loadPersonel()">Yenile</button>

<script>
async function addPersonel() {
  const username = document.getElementById('username').value;
  const password = document.getElementById('password').value;

  try {
    const res = await fetch('/api/users', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ username, password, role: 'personel' })
    });

    const data = await res.json();
    if(res.status === 200) {
      alert('Personel eklendi: ' + data.username);
      loadPersonel();
    } else {
      alert('Hata: ' + data.error);
    }

  } catch(err) {
    console.error(err);
    alert('Sunucu hatası!');
  }
}

async function loadPersonel() {
  const res = await fetch('/api/personel');
  const data = await res.json();
  const list = document.getElementById('personelList');
  list.innerHTML = '';
  data.forEach(p => {
    const li = document.createElement('li');
    li.textContent = `${p.id} - ${p.username} (${p.role})`;
    list.appendChild(li);
  });
}
</script>

</body>
</html>
